# VoxelProject

Программа для визуализации и скелетной деформации сегментированных воксельных моделей.

## Детали

В качестве графического API используется DirectX 12. Для загрузки исходных данных и для привязки модели к скелету используется CUDA.

Множество цветов модели переводится в палитру из 256 цветов. Для хранения модели в видеопамяти используются трехмерные текстуры.
Число и размер текстур определяется исходя из блочной декомпозиции объема модели с указанным размером блока. Определение границ блоков и заполнение текстур происходит через вычислительные шейдеры.
Для визуализации используется метод испускания лучей с ранним завершением луча и отсечением полигональной сеткой.
Для привязки вокселей модели к костям используется аналог метода [«Geodesic Voxel Binding»](https://knowledge.autodesk.com/support/maya/learn-explore/caas/CloudHelp/cloudhelp/2016/ENU/Maya/files/GUID-5EFDB81B-E332-4D6C-B1BB-0B989AD2F2C7-htm.html). 

Собранная программа находится в папке App.

## Входные данные

Исходные данные должны представлять из себя следующий набор:
* Набор изображений, определяющих цвет модели
* Набор размеченных изображений, определяющих сегментацию модели
* Таблица сегментации, ставящая в соответствие каждому цвету на размеченных изображениях определенный сегмент

Загрузка модели из изображений осуществляется через меню **File – Load from images** главного окна. При этом в появившемся диалоговом окне требуется выбрать текстовый файл, содержащий следующие 6 строк:
1)	Название модели
2)	Путь к папке с изображениями для цвета
3)	Путь к папке с изображениями для сегментации
4)	Путь к таблице сегментов
5)	Путь к таблице перевода сегментов
6)	Путь к таблице названий конечных сегментов

Каждое изображение должно иметь в качестве имени свой порядковый номер.

Таблица сегментов - текстовый файл, каждая строка которого имеет следующий формат:

|Название сегмента|R|G|B|Номер первого изображения, где встречается сегмент|Номер последнего изображения, где встречается сегмент|
|-----------------|-|-|-|--------------------------------------------------|-----------------------------------------------------|

Все элементы строки отделяются друг от друга пробелом.

Таблица перевода сегментов нужна для групировки исходных сегментов или изменения индекса сегмента. Конечное число сегментов не должно превышать 256.
Таблица перевода сегментов - текстовый файл. Номер строки в документе соответствует старому номеру сегмента; число, находящееся на этой строке, представляет новый номер.

Таблица названий конечных сегментов - текстовый файл, в каждой строке которого указано название сегмента с номером равным номеру строки.

Загруженную модель можно сохранить в бинарный формат через меню **File – Save binary file**, для ускорения загрузки в дальнейшем. Загрузка модели в бинарном формате осуществляется через меню **File – Load binary file**.

[Ссылка](https://drive.google.com/open?id=19FUD6hrs_z3mLmgqyIOtP_gQnThE5psU) на предобработанные данные проекта [«Visible Korean»](http://vkh3.kisti.re.kr/), сохраненные в бинарном формате.

[Ссылка](https://drive.google.com/open?id=1Q_XoxQAD-lv_Q-jBWNU7Q6vnLbP21yJz) на те же данные с привязанным скелетом.

## Примеры визуализации

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_001.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_002.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_003.jpg)

## Примеры скелетной деформации

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_004.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_005.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_006.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_007.jpg)

![alt text](https://github.com/IDDruzhin/VoxelProject/blob/master/Samples/Sample_008.jpg)
